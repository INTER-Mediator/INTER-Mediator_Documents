<!DOCTYPE html>
<!--
/*
 * INTER-Mediator Ver.@@@@2@@@@ Released @@@@1@@@@
 *
 *   Copyright (c) 2010-2016 INTER-Mediator Directive Committee, All rights reserved.
 *
 *   This project started at the end of 2009 by Masayuki Nii  msyk@msyk.net.
 *   INTER-Mediator is supplied under MIT License.
 */
-->
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>INTER-Mediatorがインストールされた動くサーバーのVirtual Machine - Product Manual - INTER-Mediator</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../../lib/css/normalize.min.css" rel="stylesheet" media="screen">
    <link href="../../lib/css/style.min.css" rel="stylesheet" media="screen">
    <link href="../../lib/css/nav.min.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="../../lib/css/styles/tomorrow-night.css">
    <link rel="shortcut icon" href="../images/im-icon.png" type="image/png">
    <link rel="icon" href="../images/im-icon.png" type="image/png">
    <script src="../../lib/pagebuilder-r2.js"></script>
    <script src="../../lib/pagebuilder-r2.php"></script>
    <script src="../../lib/highlight.pack.js"></script>
    <script>
    hljs.initHighlightingOnLoad()
    </script>
</head>

<body class="docs" data-page-title="for-novices">
    <div class="container clearfix">
        <div class="page-title">
            <h1>INTER-Mediatorがインストールされた動くサーバーのVirtual Machine</h1>
        </div>
        <div class="docs-sidebar sticky clearfix">
            <nav>
                <ul id="pageIndex">
                </ul>
            </nav>
        </div>
        <article>
            <section>
                <h1>はじめに</h1>
                <p class="lead">INTER-Mediatorの試用や学習用に、即座にサーバーとして利用できるVirtual Machine（VM）についての情報をこの文書に記載します。VMを自分で作成するか、あるいはすでに作成されているVMをダウンロードするかして利用できます。</p>
                <p class="infobox red">このVirtual Machineは、特定のホスト内でのみ利用することを想定して、ログインアカウントなどを見える場所に記載しています。学習用に定義ファイルとページファイルをブラウザーで編集できる状態にしているため、Virtual Machineとして配布している「INTER-Mediator-Server VM」をそのままインターネットに公開することは絶対に行わないでください。</p>
            </section>
            <section>
                <h1>使用までの準備</h1>
                <p>VMは、VirtualBox用を提供します。アプリケーション形式のVirtualBoxを以下の方法で、ご自分のパソコンにインストールしておいてください。</p>

                <h3>VirtualBoxのインストール</h3>
                <p>Windows、Mac、Linux、Solarisで利用できるVirtual Machine実行環境の「VirtualBox」は、Oracle社が開発してフリーで配布しているものです。<a href="https://www.virtualbox.org/wiki/Downloads" target="_blank">こちらのページ</a>より、ご利用のホストコンピュータに対応したVirtualBoxをダウンロードしてご利用ください。</p>
            </section>
            <section>
                <h1>INTER-Mediator-Server VMのダウンロード</h1>
                <p>INTER-Mediator-Server VMは以下のリンクよりダウンロードしてください。1.6GBほどあります。</p>
                <ul>
                    <li>
                        <a href="https://inter-mediator.com/archives/INTER-Mediator-Server-VM-5.3.ova">INTER-Mediator-Server VM 5.3</a>（最終更新日：2016/02/21）<!-- SHA-256 checksum: c0c53f9a0e5b9c351c8208bdb477871c1ae143d3920eb89a88e12a0e4a65f701 -->
                    </li>
                    <li>
                        <a href="https://inter-mediator.com/archives/INTER-Mediator-Server-VM-5.2.ova">INTER-Mediator-Server VM 5.2</a>（最終更新日：2015/08/24）
                    </li>
                </ul>
            </section>
            <section>
                <h1>VMの準備</h1>
                <p>VMをINTER-Mediatorに含まれているスクリプト等を利用して自分で生成する方法を「VMを自分で作成して起動する」に、一方、すでに誰かが作ったVMを利用する方法を「VMをダウンロードして利用する」に解説します。もちろん、いずれか一方の作業を行うことで、VMを利用することができるので、状況に応じて使い分けてください。</p>

                <h3>VMをダウンロードして利用する</h3>
                <p>以下の手順は、VirtualBoxの初期状態を仮定しています。他の利用などでさまざまな設定がある場合には、手順が異なるかもしれませんが、原則として、ホストオンリーネットワークを用意して、そのネットワークを使用してVMが起動するようにセットアップされていればOKです。ダウンロードしたVMは、OS XでもWindowsでも、プラットフォームに関係なく利用できます。ただし、FileMaker Serverの場合には、VMとホスト側のIPアドレスが以下で行われる設定と同一である必要があります。</p>

                <h4>VirtualBoxの準備</h4>
                <p>VirtualBoxで稼働させるゲストのネットワーク環境にはいくつかありますが、「ホストオンリーネットワーク」を利用します。この方法だと、ゲストOS自体は、ホストマシン外からのネットワークアクセスはできなくなります。また、ゲストOSからホストOSへの接続も可能です。作成されるVMは、ホストオンリーネットワークであることを前提としているので、それ以外の設定での利用では、VMの状況を確認するなどして、ご自分で対処する必要があります。</p>
                <p>Windowsでは、「ホストオンリーネットワーク」が最初から1つ作成されています。確認のため、「ファイル」メニューから「環境設定」を選択して、ダイアログボックスの左側で「ネットワーク」を選択し、「ホストオンリーネットワーク」のタブを選択します。そこに最初から「VirtualBox Host-Only Ethernet Adapter」が存在することを確認してください。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9518.png">
                </div>
                <p>Mac版では、「ホストオンリーネットワーク」は最初は1つもありません。「VirtualBox」メニューの「環境設定」を選択してダイアログボックスを表示します。ツールバーにある「ネットワーク」を選択します。さらに、「ホストオンリーネットワーク」のタブを選択します。ここに何もない場合には、リストの右側の3つあるアイコンの一番上をクリックして、項目を1つ作ります。作成されたままの状態で通常はかまいません。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9515.png">
                </div>

                <h4>ダウンロードした.ovaファイルの読み込み</h4>
                <p>WindowsおよびMacのいずれの場合でも、「ファイル」メニューから「仮想アプライアンスのインポート」を選択してください。そして、ダウンロードしたファイルを指定して読み込み、「VirtualBox マネージャー」の画面の左側に新しい項目ができていることを確認します。</p>

                <h4>INTER-Mediator-Server VMのネットワーク設定</h4>
                <p>「VirtualBox マネージャー」で、読み込んだINTER-Mediator-Server VMの項目を選択します。そして、ツールバーの「設定」アイコンをクリックします。すると、そのVirtual Machineの設定が画面が表示されます。</p>
                <p>Windowsでは、画面左側のリストで「ネットワーク」を選択します、さらに「アダプター2」のタブを選択します。そして、「割り当て」のポップアップメニューで「ホストオンリーアダプター」を選択します。すると、「名前」のところは、自動的に、「ホストオンリーネットワーク」に定義された名前が見えています。そこまでを確認して、OKボタンをクリックします。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9517.png">
                </div>
                <p>Macの場合は、ツールバーの「ネットワーク」を選択して、さらに「アダプター2」のタブを選択します。そして、「割り当て」のポップアップメニューで「ホストオンリーアダプター」を選択します。すると、「名前」のところは、自動的に、「ホストオンリーネットワーク」に定義された名前が見えています。そこまでを確認して、OKボタンをクリックします。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9516.png">
                </div>
            </section>
            <section>
                <h1>INTER-Mediator-Server VMの利用</h1>
                <p>以上の準備ができれば、VirtualBox マネージャーでINTER-Mediator-Server VMの項目を選択して「起動」ボタンをクリックします。黒いコンソール画面に文字が流れて起動します。ログインプロンプトが表示されます。Webブラウザから「<a href="http://192.168.56.101" target="_blank">http://192.168.56.101</a>」に接続してください。すると、このINTER-Mediator-Server VMで利用出来る機能などなどが見えるページがあります。</p>
                <p>「サンプルプログラム」のリンクからは、INTER-MediatorのSamplesフォルダの内容を即座に稼働させることができます。ホスト側でFileMaker Serverが稼働している場合、INTER-Mediatorのディストリビューションの中にあるdist-docs/TestDB.fmp12をサーバーに登録してXML共有ができる状態になっていれば、ゲストからホストに接続して動作するので、FileMaker Serverのサンプルも試せます。FileMaker Serverが稼働していない場合には、FileMaker Serverのサンプルはエラーが出ます。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9633.png">
                </div>
                <p>また、Webブラウザ上で、定義ファイルとページファイルを修正して、実際にプログラムした結果を参照することもできます。たとえば、ページファイルのpage01.htmlを開くリンクだけでなく、page01.htmlを編集するリンクはHTMLエディタを表示します。また、def01.phpはpage01.htmlからSCRIPTタグで参照されている定義ファイルで、定義ファイルエディタを開いて修正もできるようになっています。</p>
                <div class="picture">
                    <img class="picture-small picture-dummy" src="/images/shot9634.png">
                </div>

                <h3>「http://192.168.56.101」に接続できない場合</h3>
                <p>INTER-Mediator-Server VMが起動しているのなら、ユーザ名「developer」、パスワード「im4135dev」でログインをしてみて、「ifconfig」コマンドを実行してください。そこに、INTER-Mediator-Server VMが現在使用しているIPアドレスが見えます。eth1と記述された塊の中の、inet addrの後のIPアドレスが、現在のゲストOSのIPアドレスです。ホスト側でWebブラウザを起動して、そのIPアドレスで接続をしてみてください。</p>
                <p>それでも考えられるのは次のようなことです。</p>
                <ul>
                    <li>そもそも、VirtualBox自体がきちんと動かない状態である。Windowsで仮想化機能が無効になっている、Windows 10でHyper-Vを有効にしている、VMwareで稼働するWindowsの上でさらにINTER-Mediator-Server VMを使用しようとした、など。</li>
                    <li>ここまでに説明したネットワークの設定が正しく行われていない。あるいは、以前にその種の設定を独自に変更してしまっている。</li>
                    <li>なんらかの設定により、ホストからゲストへのIP接続ができない状態になっている。VirtualBoxでの設定次第で、あり得ると考えられます。</li>
                </ul>

                <h3>自分で作ったファイルを運用する</h3>
                <p>「http://192.168.56.101」に接続したページに、ログイン可能なアカウントが末尾に書かれています。それをご利用ください。SFTPでファイルの転送をするのが手軽かと思われます。また、INTER-Mediator-Server VM自体にログインをして、独自のデータベーススキーマを読み込ませるなどしてください。データベースの管理アカウントも、「http://192.168.56.101」に接続したページに記載しています。</p>

                <h3>INTER-Mediatorをアップデートする</h3>
                <p>ホストマシン上で、sshにより「192.168.56.101」に接続してください。ユーザー名は「developer」、パスワードは「im4135dev」です。例えば、OS Xの場合は「ターミナル」アプリケーションで、「ssh developer@192.168.56.101」とコマンドを入れて、パスワードがその後にたずねられるので、キータイプをします。Windowsの場合は、TeraTermやPuTTY等のアプリケーションをご利用ください。</p>
                <p>INTER-Mediator Ver.5.2（Ver.5.2-RC3を含む）以降のINTER-Mediator-Server VMの場合、以下のようにコマンドを入力します。</p>
                <div class="code">
<pre><code>cd /var/www/html/INTER-Mediator
git pull origin stable</code></pre>
</div>
                <p>INTER-Mediator Ver.5.2-RC1およびそれ以前のINTER-Mediator-Server VMの場合、以下のようにコマンドを入力します。checkoutの後にスペースとドット（git checkout .）を入れるのを忘れないようにして下さい。</p>
                <div class="code">
<pre><code>cd /var/www/html/INTER-Mediator
git checkout .
git pull origin stable</code></pre>
</div>
                <p>GitHubのリポジトリにあるINTER-Mediatorの最新安定版がVMに反映されます。なお、開発版の最新状況を反映させる場合には「git pull origin stable」の代わりに「git pull origin master」を実行します。現在のバージョンは、INTER-Mediator以下、dist-docs/build.shというスクリプトの最初の方のバージョン記述を確認してください。反映されている最終的なコミットは、git logやgit showコマンドで、現在のcommitの識別子（16進数の非常に長いコードで、commitの後に続けて記述されている）を得て、GitHubのリポジトリで探してください。なお、Ver.5.1以前の場合は、アクセス権の設定が若干違います。もともと用意されているページファイルと定義ファイルの編集には問題がありませんが、自分でファイルを追加したような場合などは、アクセス権について見直してください。</p>
            </section>
            <section>
                <h1>（参考）VMを自分で作成して起動する</h1>
                <p>INTER-Mediatorの配布ファイルの中には、VMを生成するためのスクリプト等が含まれています。最新のINTER-Mediatorが組み込まれたVMを作成するには、この方法が最適です。なお、標準環境のWindowsでは、Vagrantをインストールしてもスクリプトが稼働しないので、ご注意ください（別途Git for Windowsなどのソフトウェアをインストールしてsshを実行できる環境が必要です）。</p>
                <ol>
                    <li>Vagrantをインストールします。<a href="https://www.vagrantup.com/" target="_blank">こちら</a>のページに移動して、使用するOSに対応したアプリケーションをダウンロードしてインストールします。単にインストールするだけで大丈夫です。</li>
                    <li>INTER-Mediatorの最新版をcloneします。<a href="https://github.com/INTER-Mediator/INTER-Mediator" target="_blank">こちら</a>のページににある「Clone in Desktop」ボタンを利用するのが手軽な方法です。</li>
                    <li>OS Xであればターミナルアプリケーションを起動し、cloneしたINTER-Mediatorフォルダ内のdist-docs/vm-for-trialフォルダに移動します。</li>
                    <li>「vagrant up」というコマンドを実行します。ダウンロードや作成処理に時間がかかります。概ね20分程度です。「INTER-Mediator-Server VM is ready.」と表示されたら準備完了です。</li>
                </ol>
            </section>
        </article>
    </div>
</body>

</html>
